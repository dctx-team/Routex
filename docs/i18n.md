# Routex i18n Support

Routex supports internationalization (i18n) with multiple languages.

## Supported Languages

- **English** (`en`) - Default
- **Chinese (Simplified)** (`zh-CN`)

## Configuration

### Environment Variable

Set the `LOCALE` environment variable to change the language:

```bash
# English (default)
LOCALE=en bun run start

# Chinese
LOCALE=zh-CN bun run start
```

### In Code

```typescript
import { i18n, t } from './i18n';
import { en, zhCN } from './i18n/locales';

// Initialize
i18n.addTranslations('en', en);
i18n.addTranslations('zh-CN', zhCN);

// Set locale
i18n.setLocale('zh-CN');

// Translate
console.log(t('server.starting'));
// Output (Chinese): 🎯 正在启动 Routex...

// Translate with parameters
console.log(t('init.teeStream', { count: 3 }));
// Output: 📤 Tee Stream 已初始化,包含 3 个目标
```

## API Endpoint

### GET /api/i18n/locale

Get current locale.

**Response:**
```json
{
  "success": true,
  "data": {
    "locale": "en",
    "available": ["en", "zh-CN"]
  }
}
```

### PUT /api/i18n/locale

Change locale at runtime.

**Request:**
```json
{
  "locale": "zh-CN"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "locale": "zh-CN"
  }
}
```

## Adding New Languages

1. Create a new locale file in `src/i18n/locales/`:

```typescript
// src/i18n/locales/ja.ts
import type { Translations } from './en';

export const ja: Translations = {
  server: {
    starting: '🎯 Routexを起動しています...',
    // ... other translations
  },
  // ... other sections
};
```

2. Export in `src/i18n/locales/index.ts`:

```typescript
export { en } from './en';
export { zhCN } from './zh-CN';
export { ja } from './ja';
```

3. Register in your application:

```typescript
import { ja } from './i18n/locales';

i18n.addTranslations('ja', ja);
```

4. Update the Locale type in `src/i18n/index.ts`:

```typescript
export type Locale = 'en' | 'zh-CN' | 'ja';
```

## Translation Keys

All translation keys are organized by feature:

- `server.*` - Server lifecycle messages
- `init.*` - Initialization messages
- `channel.*` - Channel management
- `routing.*` - Routing and load balancing
- `circuitBreaker.*` - Circuit breaker
- `transformer.*` - Transformers
- `tee.*` - Tee Stream
- `request.*` - Request handling
- `analytics.*` - Analytics and metrics
- `error.*` - Error messages
- `api.*` - API responses
- `health.*` - Health checks
- `gettingStarted.*` - Getting started guide

## Fallback Behavior

If a translation key is not found in the current locale, the system will:
1. Try the fallback locale (English by default)
2. Return the key itself if not found in fallback

Example:
```typescript
i18n.setLocale('zh-CN');
console.log(t('nonexistent.key'));
// Output: nonexistent.key
```

## Interpolation

Use `{{param}}` syntax for parameter interpolation:

```typescript
// In translation file
{
  "greeting": "Hello, {{name}}!"
}

// In code
t('greeting', { name: 'Alice' })
// Output: Hello, Alice!
```
